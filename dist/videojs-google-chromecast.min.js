/*! @name videojs-google-chromecast @version 0.0.6 @license UNLICENSED */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self).videojsGoogleChromecast=t(e.videojs)}(this,(function(e){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var t=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t};var i=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},r=(e.getComponent("Component"),e.getComponent("ControlBar"),e.getComponent("Button"),e.getComponent("Tech")),n="IDLE",a="BUFFERING",o="PLAYING",s="PAUSED",l=function(r){function l(e,t){var n;return void 0===t&&(t={}),(n=r.call(this,e,t)||this).castBtn=n.options_.source.cast_,n.apiSession=n.options_.source.apiSession,n.receiver=n.apiSession.getCastDevice().friendlyName,n.castBtn.currentTech=i(n),n.initializeUI(),n.initializeTracks(),n.update(),n.triggerReady(),n}t(l,r);var c=l.prototype;return c.initializeUI=function(){var e=this;this.on("dispose",(function(){console.log("dispose triggered"),e.onMediaStatusUpdate(),e.onSessionUpdate(!1)}))},c.initializeTracks=function(){var t=this.textTracks();if(t){var i=this.handleTextTracksChange.bind(this);t.addEventListener("change",i),this.on("dispose",(function(){t.removeEventListener("change",i)})),this.handleTextTracksChange()}try{if(t=this.audioTracks()){var r=this.handleAudioTracksChange.bind(this);t.addEventListener("change",r),this.on("dispose",(function(){t.removeEventListener("change",r)}))}}catch(t){e.log("get player audioTracks fail"+t)}try{if(t=this.videoTracks()){var n=this.handleVideoTracksChange.bind(this);t.addEventListener("change",n),this.on("dispose",(function(){t.removeEventListener("change",n)}))}}catch(t){e.log("get player videoTracks fail"+t)}},c.createEl=function(){return e.dom.createEl("div",{id:this.options_.techId,className:"vjs-tech vjs-tech-chromecast"})},c.update=function(){this.el_.innerHTML='<div class="casting-image" style="background-image: url(\''+this.options_.poster+'\')"></div><div class="casting-overlay"><div class="casting-information"><div class="casting-icon"></div><div class="casting-description"><small>'+this.localize("CASTING TO")+"</small><br>"+this.receiver+"</div></div></div>"},c.onSessionUpdate=function(e){if(this.apiSession)return e?void 0:this.onStopAppSuccess()},c.onStopAppSuccess=function(){this.stopTrackingCurrentTime(),this.apiSession=null},c.onMediaStatusUpdate=function(){if(this.apiSession)switch(this.castBtn.playerState){case a:this.trigger("waiting");break;case n:this.trigger("timeupdate"),this.trigger("ended");break;case s:this.trigger("pause"),this.paused_=!0;break;case o:this.trigger("playing"),this.trigger("play"),this.paused_=!1}},c.src=function(e){},c.currentSrc=function(){if(this.apiSession)return this.castBtn.sources.src},c.handleAudioTracksChange=function(){var e=[],t=this.textTracks(),i=this.audioTracks();if(i){for(var r=0;r<i.length;r++){i[r].enabled&&e.push(r+1+t.length)}this.apiSession&&e.length&&(this.tracksInfoRequest=new chrome.cast.media.EditTracksInfoRequest(e),console.log("tracks are changing in remote"))}},c.handleVideoTracksChange=function(){},c.handleTextTracksChange=function(){var e=[],t=this.textTracks();if(t){for(var i=0;i<t.length;i++){"showing"===t[i].mode&&e.push(i+1)}this.apiSession&&e.length&&(this.tracksInfoRequest=new chrome.cast.media.EditTracksInfoRequest(e),console.log("tracks are requested in remote"))}},c.onTrackSuccess=function(){return e.log("track added")},c.onTrackError=function(t){return e.log("Cast track Error: "+JSON.stringify(t))},c.castError=function(t){return e.log("Cast Error: "+JSON.stringify(t))},c.controls=function(){return!1},c.play=function(){if(this.apiSession)return this.paused_&&this.castBtn.playerHandler.play(),this.paused_=!1},c.pause=function(){if(this.apiSession)return this.paused_||this.castBtn.playerHandler.pause(),this.paused_=!0},c.paused=function(){return this.paused_},c.ended=function(){return"FINISHED"===chrome.cast.media.IdleReason},c.currentTime=function(){return this.apiSession?this.castBtn.remotePlayer.currentTime:0},c.setCurrentTime=function(e){var t=0;return this.apiSession?(t=e,this.castBtn.remotePlayer.currentTime=t,this.castBtn.remotePlayerController.seek(),t):t},c.volume=function(){return this.volume_},c.buffered=function(){},c.duration=function(){return this.apiSession?this.castBtn.player_.duration():0},c.seeked=function(){console.log("has seekd")},c.seeking=function(){return console.log("is seeking"),!0},c.seekable=function(){return console.log("is seekable"),!0},c.setVolume=function(e,t){var i;if(void 0===t&&(t=!1),this.apiSession)return(i=new chrome.cast.Volume).level=e,i.muted=t,this.volume_=i.level,this.muted_=t,(new chrome.cast.media.VolumeRequest).volume=i,this.trigger("volumechange")},c.muted=function(){return this.muted_},c.setMuted=function(e){return this.setVolume(this.volume_,e)},c.supportsFullScreen=function(){return!1},c.resetSrc_=function(e){e()},c.dispose=function(){r.prototype.dispose.call(this,this)},c.playbackRate=function(){return 1},l}(r);l.prototype.paused_=!1,l.prototype.options_={},l.isSupported=function(){return!0},r.withSourceHandlers(l),l.nativeSourceHandler={},l.nativeSourceHandler.canPlayType=function(e){return/^application\/(?:dash\+xml|(x-|vnd\.apple\.)mpegurl)/i.test(e)?"probably":/^video\/(mpd|mp4|webm|m3u8)/i.test(e)?"maybe":""},l.nativeSourceHandler.canHandleSource=function(e){return e.type?l.nativeSourceHandler.canPlayType(e.type):e.src?l.nativeSourceHandler.canPlayType(e.src):""},l.nativeSourceHandler.handleSource=function(e,t){t.src(e.src)},l.nativeSourceHandler.dispose=function(){},l.registerSourceHandler(l.nativeSourceHandler),l.prototype.featuresVolumeControl=!0,l.prototype.featuresPlaybackRate=!0,l.prototype.movingMediaElementInDOM=!0,l.prototype.featuresTimeupdateEvents=!0,l.prototype.featuresProgressEvents=!0,l.prototype.featuresNativeTextTracks=!0,l.prototype.featuresNativeAudioTracks=!0,l.prototype.featuresNativeVideoTracks=!0,e.options.chromecast={},void 0===r.getTech("ChromecastTech")&&r.registerTech("ChromecastTech",l);var c=e.getComponent("Component"),u=e.getComponent("ControlBar"),d=e.getComponent("Button"),p=(e.getComponent("Tech"),"IDLE"),h="BUFFERING",m="LOADED",y="PLAYING",f="PAUSED",v=function(r){function n(e,t){var n;return(n=r.call(this,e,t)||this).sources={},n.player=e,n.options=t,n.casting=!1,n.apiSession=null,n.tryingReconnect=0,n.mDNS=!1,n.choosenDevice=null,void 0!==n.options.mdns&&n.options.mdns&&(n.mDNS=!0,n.receivers=[]),n.hide(),n.initPlayerHandler(i(n)),n.playerState=p,n.playerStateBeforeSwitch=null,n.remotePlayer=null,n.remotePlayerController=null,n.currentMediaTime=0,n.mediaDuration=-1,n.incrementMediaTimeHandler=n.incrementMediaTime.bind(i(n)),n.mediaInfo=null,n.setupLocalPlayer(),n.addVideoThumbs(),n.initializeUI(e),n}t(n,r);var a=n.prototype;return a.initCastPlayer=function(){if(void 0!==typeof window.cast){var e=this,t=e.options;if(void 0!==t.appId&&""!==t.appId?this.appId=t.appId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID&&(this.appId=chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID),void 0!==t.autoJoinPolicy&&""!==t.autoJoinPolicy?this.autoJoinPolicy=t.autoJoinPolicy:chrome.cast.AutoJoinPolicy.PAGE_SCOPED&&(this.autoJoinPolicy=chrome.cast.AutoJoinPolicy.PAGE_SCOPED),cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:this.appId,autoJoinPolicy:this.autoJoinPolicy}),void 0!==this.options.mdns&&this.options.mdns){var i=new(require("chromecast-api"));this.client=i,this.mDNS=!0,this.choosenDevice=null,this.client.on("device",(function(t){void 0!==t&&(e.receivers.push(t),e.show())}))}this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,function(e){this.switchPlayer(e.value)}.bind(this)),this.apiInitialized=!0}else console.log("it is undefined")},a.initPlayerHandler=function(e){void 0===e&&(e={}),this.playerHandler={},this.playerHandler.target={},this.playerHandler.setTarget=function(t){e.playerHandler.target=t},this.playerHandler.play=function(){e.playerState!=p&&e.playerHandler.target.isMediaLoaded()?(e.playerState=y,e.playerHandler.target.play()):e.playerHandler.load()},this.playerHandler.pause=function(){e.playerState=f,e.playerHandler.target.pause()},this.playerHandler.stop=function(){e.playerState=p,e.playerHandler.target.stop()},this.playerHandler.load=function(){e.playerState=h,e.playerHandler.target.load()},this.playerHandler.isMediaLoaded=function(){return e.playerHandler.target.isMediaLoaded()},this.playerHandler.prepareToPlay=function(){e.mediaDuration=e.playerHandler.getMediaDuration(),e.playerHandler.updateDurationDisplay(),e.playerState=m,e.playerHandler.play(),e.playerHandler.updateDisplay()},this.playerHandler.getCurrentMediaTime=function(){return e.playerHandler.target.getCurrentMediaTime()},this.playerHandler.getMediaDuration=function(){return e.playerHandler.target.getMediaDuration()},this.playerHandler.updateDisplay=function(){e.playerHandler.currentMediaTime=e.playerHandler.target.getCurrentMediaTime(),e.playerHandler.mediaDuration=e.playerHandler.target.getMediaDuration(),e.playerHandler.target.updateDisplay()},this.playerHandler.updateCurrentTimeDisplay=function(){e.playerHandler.target.updateCurrentTimeDisplay()},this.playerHandler.updateDurationDisplay=function(){e.playerHandler.target.updateDurationDisplay()},this.playerHandler.setTimeString=function(t){e.playerHandler.target.setTimeString(t)},this.playerHandler.setVolume=function(t){e.playerHandler.target.setVolume(t)},this.playerHandler.mute=function(){e.playerHandler.target.mute()},this.playerHandler.unMute=function(){e.playerHandler.target.unMute()},this.playerHandler.isMuted=function(){return e.playerHandler.target.isMuted()},this.playerHandler.seekTo=function(t){e.playerHandler.target.seekTo(t)}},a.initializeUI=function(e){var t=this;void 0!==e.controlBar&&(this.createGoogleButton(),this.mDNS&&this.createCustomButton(),e.controlBar.chromecastButton=this,this.on(e,"seeked",(function(){t.casting&&t.apiSession?t.seekMedia(t.player_.currentTime()):t.mDNS&&null!==t.choosenDevice&&(t.choosenDevice.on("status",(function(e){console.log(e)})),t.choosenDevice.seekTo(t.player_.currentTime(),(function(e){console.log("seek to position")})))})),this.on(e,"play",(function(e){t.casting&&t.apiSession?t.playerHandler.play():t.mDNS&&null!==t.choosenDevice&&(t.choosenDevice.on("status",(function(e){console.log(e)})),t.choosenDevice.resume((function(e){console.log("play cast")})))})),this.on(e,"pause",(function(e){t.casting&&t.apiSession?t.playerHandler.pause():t.mDNS&&null!==t.choosenDevice&&(t.choosenDevice.on("status",(function(e){console.log(e)})),t.choosenDevice.pause((function(e){console.log("pause cast")})))})),this.on(e,"volumechange",(function(e){if(t.casting&&t.apiSession){var i=t.player_.volume();t.player_.muted()?(t.playerHandler.mute(),i=0):t.playerHandler.unMute(),t.playerHandler.setVolume(i)}else if(t.mDNS&&null!==t.choosenDevice){i=t.player_.volume();t.player_.muted()&&(i=0),t.choosenDevice.on("status",(function(e){console.log(e)})),t.choosenDevice.setVolume(i,(function(e){console.log("pause cast")}))}})),this.on(e,"loadedmetadata",(function(e){t.onMediaLoadedLocally(t)})),this.on(e,"dispose",(function(){t.casting&&t.apiSession?(t.disposed=!0,t.stop()):t.mDNS&&null!==t.choosenDevice&&(t.choosenDevice.on("status",(function(e){console.log(e)})),t.choosenDevice.stop((function(e){console.log("stop cast")})))})))},a.createGoogleButton=function(){var e=document.getElementsByClassName("vjs-control-bar");if(document.getElementsByClassName("vjs-chromecast-button").length<=0){var t=document.createElement("google-cast-launcher");t.setAttribute("class","vjs-chromecast-button vjs-control vjs-button"),t.setAttribute("type","button"),e.length>0&&e[0].appendChild(t)}},a.createCustomButton=function(){var e=this,t=document.getElementsByClassName("vjs-control-bar");if(document.getElementsByClassName("vjs-chromecast-button-mdns").length<=0){var i=document.createElement("button");if(i.setAttribute("class","vjs-chromecast-button-mdns vjs-control vjs-button"),i.setAttribute("type","button"),i.addEventListener("click",(function(){if(e.findSources(),void 0===e.client){var t=new(require("chromecast-api"));e.client=t,e.client.on("device",(function(t){void 0!==t&&e.receivers.push(t)}))}for(var i=0;i<e.receivers.length;i++)"Séjour"==e.receivers[i].friendlyName&&(e.choosenDevice=e.receivers[i],e.receivers[i].play(e.sources.src,(function(e){})))})),t.length>0){t[0].appendChild(i);var r=document.createElement("span");r.setAttribute("class","vjs-icon-chromecast"),document.getElementsByClassName("vjs-chromecast-button-mdns")[0].appendChild(r)}}},a.hide=function(){r.prototype.hide.call(this);var e=e=document.getElementsByClassName("vjs-chromecast-button");e.length>0&&(e[0].style.display="none"),this.mDNS&&(e=document.getElementsByClassName("vjs-chromecast-button-mdns")).length>0&&(e[0].style.display="none")},a.show=function(){r.prototype.show.call(this);var e=null;(e=this.mDNS?document.getElementsByClassName("vjs-chromecast-button-mdns"):document.getElementsByClassName("vjs-chromecast-button")).length>0&&(e[0].style.display="block")},a.buildCSSClass=function(){return this.mDNS?"vjs-chromecast-button-mdns "+r.prototype.buildCSSClass.call(this,this):"vjs-chromecast-button "+r.prototype.buildCSSClass.call(this,this)},a.receiverListener=function(e){if(!this.disposed)return"available"===e?this.show():this.hide()},a.findSources=function(){var e=null;return null===this.player_?void 0!==this.player.cache_&&null!=this.player.cache_.source&&(e=this.player.cache_.source):e=this.player_.currentSource(),this.sources=e,this.sources},a.switchPlayer=function(e){this.playerStateBeforeSwitch=this.playerState,e&&cast&&cast.framework&&this.remotePlayer.isConnected?(this.playerHandler.pause(),this.setupRemotePlayer()):this.setupLocalPlayer()},a.setupRemotePlayer=function(){console.log(this.remotePlayerController),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.MEDIA_INFO_CHANGED,function(e){var t=cast.framework.CastContext.getInstance().getCurrentSession();if(!t)return this.mediaInfo=null,void this.playerHandler.updateDisplay();var i=t.getMediaSession();if(!i)return this.mediaInfo=null,void this.playerHandler.updateDisplay();this.apiSession=t,this.mediaInfo=i.media,this.mediaInfo&&(this.isLiveContent=this.mediaInfo.streamType==chrome.cast.media.StreamType.LIVE),i.playerState==y&&this.playerState!==y&&this.playerHandler.prepareToPlay(),this.playerHandler.updateDisplay()}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.CAN_SEEK_CHANGED,function(e){}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED,function(){this.remotePlayer.isPaused?this.playerHandler.pause():this.playerState!==y&&this.playerHandler.play()}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,function(){this.remotePlayer.isMuted?this.playerHandler.mute():this.playerHandler.unMute()}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,function(){var e=this.remotePlayer.volumeLevel;this.player_.setVolume(e)}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_PLAYING_BREAK_CHANGED,function(e){this.isPlayingBreak(e.value)}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.WHEN_SKIPPABLE_CHANGED,function(e){this.onWhenSkippableChanged(e.value)}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.CURRENT_BREAK_CLIP_TIME_CHANGED,function(e){this.onCurrentBreakClipTimeChanged(e.value)}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.BREAK_CLIP_ID_CHANGED,function(e){this.onBreakClipIdChanged(e.value)}.bind(this)),this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.LIVE_SEEKABLE_RANGE_CHANGED,function(t){e.log("LIVE_SEEKABLE_RANGE_CHANGED"),this.liveSeekableRange=t.value}.bind(this));var t={};t.play=function(){this.remotePlayer.isPaused&&(this.remotePlayerController.playOrPause(),this.player_.play())}.bind(this),t.pause=function(){this.remotePlayer.isPaused||(this.remotePlayerController.playOrPause(),this.player_.pause())}.bind(this),t.stop=function(){this.remotePlayerController.stop()}.bind(this),t.load=function(){this.findSources(),e.log("Loading... test");var t=new chrome.cast.media.MediaInfo(this.sources.src,this.sources.type);t.streamType=chrome.cast.media.StreamType.BUFFERED,t.metadata=new chrome.cast.media.TvShowMediaMetadata,t.metadata.title="test",t.metadata.subtitle="subtest";var i=this.player_.poster();i&&(image=new chrome.cast.Image(i),t.metadata.images=[{url:image}]);var r=new chrome.cast.media.LoadRequest(t);r.currentTime=this.currentMediaTime,this.playerStateBeforeSwitch&&this.playerStateBeforeSwitch!=f?r.autoplay=!0:r.autoplay=!1,cast.framework.CastContext.getInstance().getCurrentSession().loadMedia(r).then(function(){this.casting=!0,e.log("Remote media loaded")}.bind(this),function(t){this.playerState=p,e.log("Remote media load error: "+this.getErrorMessage(t)),this.playerHandler.updateDisplay()}.bind(this))}.bind(this),t.isMediaLoaded=function(){var e=cast.framework.CastContext.getInstance().getCurrentSession();if(!e)return!1;var t=e.getMediaSession();return!!t&&(t.playerState!=p&&(this.apiSession=e,!0))}.bind(this),t.getCurrentMediaTime=function(){return this.remotePlayer.currentTime}.bind(this),t.getMediaDuration=function(){return this.remotePlayer.duration}.bind(this),t.updateDisplay=function(){var e=cast.framework.CastContext.getInstance().getCurrentSession();if(e&&e.getMediaSession()&&e.getMediaSession().media){var t=e.getMediaSession().media,i="",r="",n="";t.metadata&&(i=t.metadata.title,i=(i=(r=t.metadata.episodeTitle)?i+": "+r:i)?i+" ":"",n=(n=t.metadata.subtitle)?n+" ":"")}else{this.currentTech.dispose(),this.casting=!1;var a=this.player_.currentTime();this.removeClass("connected"),this.player_.src(this.player_.options_.sources),this.player_.paused()||this.player_.one("seeked",(function(){return this.player_.play()})),this.player_.currentTime(a),this.player_.options_.inactivityTimeout=this.inactivityTimeout}}.bind(this),t.updateCurrentTimeDisplay=function(){this.playerHandler.setTimeString(this.playerHandler.getCurrentMediaTime())}.bind(this),t.updateDurationDisplay=function(){this.playerHandler.setTimeString(this.playerHandler.getMediaDuration())}.bind(this),t.setTimeString=function(e){this.getMediaTimeString(e)}.bind(this),t.setVolume=function(e){var t=this.remotePlayer.volumeLevel;t=e>1?1:e,this.remotePlayer.volumeLevel=t,this.remotePlayerController.setVolumeLevel()}.bind(this),t.mute=function(){this.remotePlayer.isMuted||this.remotePlayerController.muteOrUnmute()}.bind(this),t.unMute=function(){this.remotePlayer.isMuted&&this.remotePlayerController.muteOrUnmute()}.bind(this),t.isMuted=function(){return this.remotePlayer.isMuted}.bind(this),t.seekTo=function(e){this.remotePlayer.currentTime=e,this.remotePlayerController.seek()}.bind(this),this.playerHandler.setTarget(t),this.remotePlayer.isMuted&&this.playerHandler.mute(),this.apiSession=cast.framework.CastContext.getInstance().getCurrentSession(),this.player_.loadTech_("ChromecastTech",{cast_:this,apiSession:this.apiSession}),this.apiSession==cast.framework.SessionState.SESSION_RESUMED?(e.log("Resuming session"),this.playerHandler.prepareToPlay()):this.playerHandler.load()},a.setupLocalPlayer=function(){var t={},i=this;t.play=function(){e.log("local player play")},t.pause=function(){e.log("local player pause")},t.stop=function(){e.log("local player stop")},t.load=function(){e.log("local player load")}.bind(this),t.isMediaLoaded=function(){return this.findSources(),this.sources.src}.bind(this),t.getCurrentMediaTime=function(){return void 0!==this.player_?this.player_.currentTime():void 0!==i.player_?i.player_.currentTime():void 0},t.getMediaDuration=function(){return void 0!==this.player_?this.player_.duration():void 0!==i.player_?i.player_.duration():void 0},t.updateDisplay=function(){},t.updateCurrentTimeDisplay=function(){this.currentMediaTime+=1,this.playerHandler.setTimeString(this.currentMediaTime)}.bind(this),t.updateDurationDisplay=function(){this.playerHandler.setTimeString(this.mediaDuration)}.bind(this),t.setTimeString=function(e){this.getMediaTimeString(e)}.bind(this),t.setVolume=function(e){if(i.mDNS&&i.receivers.length>0);else{if(void 0!==this.player_)return this.player_.volume(e);if(void 0!==i.player_)return i.player_.volume(e)}},t.mute=function(){return void 0!==this.player_?this.player_.mute(!0):void 0!==i.player_?i.player_.mute(!0):void 0},t.unMute=function(){return void 0!==this.player_?this.player_.mute(!1):void 0!==i.player_?i.player_.mute(!1):void 0},t.isMuted=function(){return void 0!==this.player_?this.player_.mute():void 0!==i.player_?i.player_.mute():void 0},t.seekTo=function(e){return void 0!==this.player_?this.player_.currentTime(e):void 0!==i.player_?i.player_.currentTime(e):void 0},this.playerHandler.setTarget(t),this.playerHandler.setVolume(50),this.currentMediaTime>0&&(this.playerHandler.load(),this.playerHandler.play())},a.onMediaLoadedLocally=function(){this.player_.currentTime(this.currentMediaTime),this.playerHandler.prepareToPlay()},a.addVideoThumbs=function(){},a.seekMedia=function(t){null==this.mediaDuration||cast.framework.CastContext.getInstance().getCurrentSession()&&!this.remotePlayer.canSeek?e.log("Error - Not seekable"):(this.playerState!==y&&this.playerState!==f||(this.currentMediaTime=t),this.playerHandler.seekTo(t))},a.getErrorMessage=function(e){switch(e.code){case chrome.cast.ErrorCode.API_NOT_INITIALIZED:return"The API is not initialized."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.CANCEL:return"The operation was canceled by the user"+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.CHANNEL_ERROR:return"A channel to the receiver is not available."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.EXTENSION_MISSING:return"The Cast extension is not available."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.INVALID_PARAMETER:return"The parameters to the operation were not valid."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:return"No receiver was compatible with the session request."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.SESSION_ERROR:return"A session could not be created, or a session was invalid."+(e.description?" :"+e.description:"");case chrome.cast.ErrorCode.TIMEOUT:return"The operation timed out."+(e.description?" :"+e.description:"");default:return e}},a.endPlayback=function(){this.currentMediaTime=0,this.playerState=p,this.this.updateDisplay()},a.getMediaTimeString=function(e){if(null==e||null==e)return null;var t=!1;e<0&&(t=!0,e*=-1);var i=Math.floor(e/3600),r=Math.floor((e-3600*i)/60),n=Math.floor(e-3600*i-60*r);return i<10&&(i="0"+i),r<10&&(r="0"+r),n<10&&(n="0"+n),(t?"-":"")+i+":"+r+":"+n},a.incrementMediaTime=function(){this.currentMediaTime=this.playerHandler.getCurrentMediaTime(),this.mediaDuration=this.playerHandler.getMediaDuration(),this.playerHandler.updateDurationDisplay(),null==this.mediaDuration||this.currentMediaTime<this.mediaDuration?this.playerHandler.updateCurrentTimeDisplay():this.mediaDuration>0&&this.endPlayback()},n}(d);v.prototype.tryingReconnect=0,v.prototype.inactivityTimeout=2e3,v.prototype.controlText_="Chromecast",u.prototype.options_.children.splice(u.prototype.options_.children.length-1,0,"chromeCastButton"),void 0===c.getComponent("ChromecastButton")&&c.registerComponent("ChromecastButton",v);var g=e.getComponent("Component"),C=(e.getComponent("ControlBar"),e.getComponent("Button"),e.getComponent("Tech"),function(e){function i(t,i){var r;r=e.call(this,t,i)||this;var n=new v(t,i);return window.__onGCastApiAvailable=function(e){e&&n.initCastPlayer()},void 0!==i.mdns&&i.mdns&&window.__onGCastApiAvailable(!0),r}return t(i,e),i}(g));C.prototype.options_={},e.options.children.push("chromecast"),e.addLanguage("en",{"CASTING TO":"CASTING TO"}),void 0===g.getComponent("Chromecast")&&g.registerComponent("Chromecast",C);var S=function(e){var t=this;if(!(!1===e||e&&!1===e.enabled)){["appId","altSource","onStop","onError"].forEach((function(i){void 0===t.options_.chromecast&&(t.options_.chromecast=[]),void 0===t.options_.chromecast[i]?e[i]="":e[i]=t.options_.chromecast[i]}));void 0!==e.mdns&&e.mdns?setTimeout((function(){new C(t,e)}),500):new C(t,e)}},T=e.registerPlugin||e.plugin;return void 0===e.getPlugin("chromecast")&&T("chromecast",S),S.VERSION="0.0.6",S}));
